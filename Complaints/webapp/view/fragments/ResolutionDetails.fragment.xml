<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:l="sap.ui.layout" >
<l:Grid defaultSpan="XL5 L5 M5 S12" hSpacing="1"   >
        <Label  text="{i18n>TtlResolutionDetails}" design="Bold" />
        <!-- Status change to be handled by System -->
        <!-- <VBox renderType="Bare" >
            <Label text="{i18n>ComplaintStatus}" required="true" />
            <Select change="onChangeStatus" editable="{= !${oModelControl>/ComplainResolved} }" selectedKey="{oModelView>/ComplaintStatus}">
                <core:Item text="Registered" key="REGISTERED" />
                <core:Item text="In Review" key="INREVIEW" />
                <core:Item text="Resolved" key="RESOLVED" />
                <core:Item text="Withdrawn" key="WITHDRAWN" />
            </Select>
        </VBox> -->
        <VBox renderType="Bare"  >
        <Label text="{i18n>ResolutionType}" required="true" />
        <Text text="{i18n>TxtResolution}" />
         <!-- ,type:'com.knpl.pragati.Complaints.model.cmbxDtype2' -->
        <!-- <ComboBox id="resolution" editable="{= !${oModelControl>/ComplainResolved} &amp;&amp; ${ResolutionId} === null  }" change="onChangeResolution" selectedKey="{path:'oModelView>/ResolutionId'}" -->
                   <ComboBox id="resolution" 
                   editable="{parts:['ApprovalStatus','ComplaintStatus', 'ResolutionId'], formatter:'.formatter.fmtVisibleFunction' }" 
                   change="onChangeResolution" 
                   selectedKey="{path:'oModelView>/ResolutionId'}"  
                   items="{path:'/MasterResolutionSet',filters:[{path:'IsArchived',operator:'EQ',value1:false}]}" required="true"  >
            <items>
                <core:Item text="{Resolution}" key="{Id}" />
            </items>
        </ComboBox>
        <TextArea maxLength="300" editable="{= !${oModelControl>/ComplainResolved} &amp;&amp; ${ResolutionId} === null }" visible="{= +${oModelView>/ResolutionId} === 90  }" value="{path:'oModelView>/ResolutionOthers',type:'sap.ui.model.type.String',constraints:{maxLength:300,search:'^[a-zA-Z0-9]{1}[wW]*'}}"></TextArea>
        <Text visible="{= ${oModelView>/ResolutionId} === 90  }" text="{i18n>TxtMaxLength}" />
        <layoutData>
          	<l:GridData linebreak="true"/>
        </layoutData>
        </VBox>        
        <VBox renderType="Bare">
            <Label text="{i18n>Remark}"  required="true" />
            <TextArea showExceededText="false" maxLength="300" rows="4" cols="50" editable="{= !${oModelControl>/ComplainResolved} }" width="100%"
             value="{ path: 'oModelView>/Remark', type: 'sap.ui.model.type.String', constraints : {  maxLength : 300 }  }" required="false" />
            <Text text="{i18n>TxtMaxLength}" />
        </VBox>
</l:Grid>
<!-- Token code scenerio -->
<Label visible="{= ${oModelView>/ResolutionType} === 1  }" text="{i18n>TtlRewardPointDetails}" design="Bold" />
<l:Grid visible="{= ${oModelView>/ResolutionType} === 1  }"  defaultSpan="XL5 L5 M5 S12" hSpacing="1"   >        
    <VBox >
           <Label  text="{i18n>TokenCode}"  />
           <HBox renderType="Bare" >
           <Input  value="{oModelView>/TokenCode}" 
            editable="{= ${ComplaintStatus} === 'INREVIEW' &amp;&amp;  ${oModelView>/RewardPoints} === '' ? true : false  }"   />  
            <Button class="sapUiTinyMarginBeginEnd" visible="{=  ${ComplaintStatus} === 'REGISTERED' ||  ${ComplaintStatus} === 'INREVIEW' }" 
              icon="sap-icon://reset" tooltip="{i18n>Reset}" press="onResetToken" />
            <Button  class="sapUiTinyMarginBeginEnd"  visible="{=  ${ComplaintStatus} === 'REGISTERED' ||  ${ComplaintStatus} === 'INREVIEW'  }" 
                       text="{i18n>btnValidate}" press="onPressTokenCode" />
        </HBox>
       </VBox>
</l:Grid>



    <!--This Grid will used when the Resolution id is 8 CR5-->
    <l:Grid visible="{= ${oModelView>/ResolutionId} === 8}" defaultSpan="XL12 L12 M12 S12" hSpacing="1" >
        <Label text="{i18n>TtlRewardPointDetails}" design="Bold" />
        <CheckBox select="fnAprvRjctVsbl" text="{i18n>aprvPdctIndvly}" visible="{= ${appView>/iUserLevel} &gt; 1 &amp;&amp; ${ApprovalStatus} === 'PENDING' }" />
    </l:Grid>
    <l:Grid visible="{= ${oModelView>/ResolutionId} === 8}" defaultSpan="XL12 L12 M12 S12" hSpacing="1" content="{oModelView>/PainterComplainProducts/results}">
        <l:Grid id="idRewardDetails" defaultSpan="XL6 L6 M6 S12" hSpacing="1" >
            <Title class="sapUiTinyMarginBottom" text="Product {oModelView>ProductNum}" design="Bold" />
            <VBox>
                <Label text="{i18n>LblCategory}" required="true" />
                <ComboBox
                    width="100%"
                    change="filterProducts"
                    editable="false"
                    selectedKey="{oModelView>ProductPackDetails/CategoryCode}"
                    items="{ path: '/MasterProductCategorySet',  sorter: { path: 'Category' }      }"
                    name="{oModelView>/PainterComplainProducts/ProductSKUCode}"
                    required="true"
                >
                    <core:Item key="{Id}" text="{Category}" />
                </ComboBox>
                <layoutData>
                    <l:GridData linebreak="true" />
                </layoutData>
            </VBox>
            <VBox>
                <Label text="{i18n>LblProduct}" required="true" />
                <ComboBox required="true" width="100%" change="filterPacks" editable="false" selectedKey="{oModelView>ProductPackDetails/ProductCode}" name="{oModelView>/PainterComplainProducts/ProductSKUCode}" items="{ path: '/MasterProductSet',    sorter: { path: 'ProductName' }      }">
                    <core:Item key="{Id}" text="{ProductName}" />
                </ComboBox>
            </VBox>
            <VBox>
                <Label required="true" text="{i18n>LblPack}" />
                <ComboBox change="onPackChange" required="true" editable="false" width="100%" selectedKey="{oModelView>ProductSKUCode}" items="{ path: '/MasterRepProductSkuSet', parameters : { expand : 'ProductDetails' }, sorter: { path: 'ProductCode' }   }">
                    <core:Item key="{SkuCode}" text="{Description}" />
                </ComboBox>
            </VBox>
            <VBox>
                <Label required="true" text="{i18n>LblQuantity}" />
                <ComboBox change="onPointsChange" required="true" editable="false" selectedKey="{oModelView>ProductQuantity}" width="100%" items="{oModelControl>/aQuantity}">
                    <core:Item key="{oModelControl>key}" text="{oModelControl>value}" />
                </ComboBox>
                <layoutData>
                    <l:GridData linebreak="true" />
                </layoutData>
            </VBox>
            <VBox>
                <Label text="{i18n>Points}" />
                <Input editable="false" value="{= (+${oModelView>Points})*(+${oModelView>ProductQuantity}) }" />
                <layoutData>
                    <l:GridData linebreak="true" />
                </layoutData>
            </VBox>
            <VBox visible="{oModelControl>/rBtnVsbl}">
                <Label text="{i18n>approveReject}" labelFor="idAprvRjct" />
				<RadioButtonGroup select="fnProductAprvRjct" selectedIndex="{= ${oModelView>Status} === 'APPROVED' ? 0 : ${oModelView>Status} === 'REJECTED' ? 1 : -1 }" columns="2" id="idAprvRjct">
					<RadioButton text="{i18n>approve}" />
					<RadioButton text="{i18n>reject}" />
				</RadioButtonGroup>
                <layoutData>
                    <l:GridData linebreak="true" />
                </layoutData>
            </VBox>
        </l:Grid>
    </l:Grid>

</core:FragmentDefinition>