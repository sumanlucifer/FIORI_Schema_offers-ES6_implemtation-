<core:FragmentDefinition xmlns:html="http://www.w3.org/1999/xhtml"
    xmlns:smartForm="sap.ui.comp.smartform"
    xmlns:smartField="sap.ui.comp.smartfield"
    xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
    xmlns="sap.m"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.ui.layout.form"
    xmlns:smartTable="sap.ui.comp.smarttable"
    xmlns:core="sap.ui.core">
    <l:VerticalLayout width="100%">
        <smartTable:SmartTable
                           id="VisitHistoryTbl"
                            editable="false"
                            width="100%"
                            entitySet="Visits"
                            beforeRebindTable="onBeforeRebindVisitHistory"
                            tableType="ResponsiveTable"
                            showRowCount="true"
                            useExportToExcel="false"
                            useVariantManagement="false"
                            useTablePersonalisation="false"
                            demandPopin="true"
                            enableAutoBinding="false"
                            placeToolbarInTable="true"
                            persistencyKey="HistoryPersistenceKey"
                            requestAtLeastFields="Id"
                            initialNoDataText="{i18n>tableNoDataText}">
         <Table growing="true" growingThreshold="10" growingScrollToLoad="false">
            <columns>
                <Column hAlign="Begin">
                    <customData>
                        <core:CustomData key="p13nData" value='\{"columnKey": "TargetLead/Id", "leadingProperty": "TargetLead/Id", "columnIndex": 0 ,"sortProperty": "TargetLead/Id","filterProperty": "TargetLead/Id"}'/>
                    </customData>
                    <Text text="{i18n>LeadId}"/>
                </Column>
                <Column hAlign="Begin">
                    <customData>
                        <core:CustomData key="p13nData" value='\{"columnKey": "DGA/GivenName", "leadingProperty": "DGA/GivenName", "columnIndex": 1 ,"sortProperty": "DGA/GivenName","filterProperty": "DGA/GivenName"}'/>
                    </customData>
                    <Text text="{i18n>DGAName}"/>
                </Column>
                <Column hAlign="Begin">
                    <customData>
                        <core:CustomData key="p13nData" value='\{"columnKey": "ConsumerName", "leadingProperty": "ConsumerName", "columnIndex": 2 ,"sortProperty": "ConsumerName","filterProperty": "ConsumerName"}'/>
                    </customData>
                    <Text text="{i18n>ConsumerName}"/>
                </Column>
                <Column hAlign="Begin">
                    <customData>
                        <core:CustomData key="p13nData" value='\{"columnKey": "TargetLead/PrimaryNum", "leadingProperty": "TargetLead/PrimaryNum", "columnIndex": 3 ,"sortProperty": "TargetLead/PrimaryNum","filterProperty": "TargetLead/PrimaryNum"}'/>
                    </customData>
                    <Text text="{i18n>ConsumerNo}"/>
                </Column>
                <Column hAlign="Begin">
                    <customData>
                        <core:CustomData key="p13nData" value='\{"columnKey": "Date", "leadingProperty": "Date", "columnIndex": 4 ,"sortProperty": "Date","filterProperty": "Date"}'/>
                    </customData>
                    <Text text="{i18n>MeetingReqDate}"/>
                </Column>
                 <Column hAlign="Begin">
                    <customData>
                        <core:CustomData key="p13nData" value='\{"columnKey": "Date", "leadingProperty": "Date", "columnIndex": 5 ,"sortProperty": "Date","filterProperty": "Date"}'/>
                    </customData>
                    <Text text="{i18n>MeetingReqTime}"/>
                </Column>
                 <Column hAlign="Begin">
                    <customData>
                        <core:CustomData key="p13nData" value='\{"columnKey": "Status", "leadingProperty": "Status", "columnIndex": 6 ,"sortProperty": "Status","filterProperty": "Status"}'/>
                    </customData>
                    <Text text="{i18n>Status}"/>
                </Column>
                 <Column hAlign="Begin">
                    <customData>
                        <core:CustomData key="p13nData" value='\{"columnKey": "Comments", "leadingProperty": "Comments", "columnIndex": 7 ,"sortProperty": "Comments","filterProperty": "Comments"}'/>
                    </customData>
                    <Text text="{i18n>Comments}"/>
                </Column>
            </columns>
            <items>
                <ColumnListItem  type="Navigation" press="onItemPress">
                    <cells>
                        <Text text="{TargetLead/Id}"/>
                        <Text text="{DGA/GivenName}"/>
                        <Text text="{path:'ConsumerName'}"/>
                        <Text text="{path:'TargetLead/PrimaryNum'}"/>
                        <Text text="{path:'Date',type:'sap.ui.model.type.Date',formatOptions:{pattern:'dd/MM/yyyy'}}"/>
                        <Text text="{path:'Date',type:'sap.ui.model.type.Date',formatOptions:{pattern:'dd/MM/yyyy'}}" />
                       <ObjectStatus text="{Status}" state="{= ${Status} === 'Completed' ? 'Success' : ${Status} === 'Rejected' ? 'Error' : 'Warning'}"/>
                       <Link
                            text="View Comment"
                            press="handleLinkPress" />
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
    </smartTable:SmartTable>
    </l:VerticalLayout>
</core:FragmentDefinition>