<mvc:View controllerName="com.knpl.pragati.SchemeOffers.controller.DetailPage" height="100%"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:layout="sap.ui.layout"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:form="sap.ui.layout.form"
    xmlns:core="sap.ui.core">
    <f:DynamicPage busy="{oModelControl3>/PageBusy}" busyIndicatorDelay="0" headerExpanded="true" stickySubheaderProvider="idIconTabBar" showFooter="true" class="sapUiNoContentPadding">
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="{Title}"/>
                </f:heading>
                <f:breadcrumbs>
                    <Breadcrumbs currentLocationText="{i18n>currentDetailPageBreadcrumbText}">
                        <Link press="onPressBreadcrumbLink" text="{i18n>homeBreadcrumbText}"/>
                    </Breadcrumbs>
                </f:breadcrumbs>
            </f:DynamicPageTitle>
        </f:title>
        <f:header>
            <f:DynamicPageHeader pinnable="true">
                <layout:HorizontalLayout allowWrapping="true">
                    <layout:VerticalLayout class="sapUiLargeMarginEnd">
                        <Avatar id="idOfferImg" displaySize="L" displayShape="Square"/>
                    </layout:VerticalLayout>
                    <layout:VerticalLayout class="sapUiLargeMarginEnd">
                        <layout:HorizontalLayout class="sapUiTinyMarginBottom">
                            <Label class="sapUiTinyMarginEnd" text="{i18n>headerCreationDate}"/>
                           <Text text="{path:'CreatedAt',type:'sap.ui.model.type.Date',formatOptions:{pattern:'dd/MM/yyyy h:mm a'}}"/>
                        </layout:HorizontalLayout>
                        <layout:HorizontalLayout class="sapUiTinyMarginTop sapUiTinyMarginBottom">
                            <Label class="sapUiTinyMarginEnd" text="{i18n>headerCreatedBy}"/>
                            <Text text="{CreatedByDetails/Name} - {CreatedByDetails/Email}"/>
                        </layout:HorizontalLayout>
                        <layout:HorizontalLayout class="sapUiTinyMarginTop sapUiTinyMarginBottom">
                            <Label class="sapUiTinyMarginEnd" text="{i18n>LastUpdatedAt}:"/>
                           <Text text="{path:'UpdatedAt',type:'sap.ui.model.type.Date',formatOptions:{pattern:'dd/MM/yyyy h:mm a'}}"/>
                        </layout:HorizontalLayout>
                         <layout:HorizontalLayout class="sapUiTinyMarginTop sapUiTinyMarginBottom">
                            <Label class="sapUiTinyMarginEnd" text="{i18n>LastUpdatedBy}:"/>
                             <Text text="{UpdatedByDetails/Name} - {UpdatedByDetails/Email}"/>
                        </layout:HorizontalLayout>
                        <!-- <layout:HorizontalLayout class="sapUiTinyMarginTop sapUiTinyMarginBottom">
                            <Label class="sapUiTinyMarginEnd" text="{i18n>headerOfferPoint}"/>
                            <Text text=""/>
                        </layout:HorizontalLayout> -->
                    </layout:VerticalLayout>
                    <layout:VerticalLayout class="sapUiLargeMarginEnd">
                      <layout:HorizontalLayout class="sapUiTinyMarginTop sapUiTinyMarginBottom">
                            <Label class="sapUiTinyMarginEnd" text="{i18n>OfferCode}:"/>
                            <Text text="{OfferCode}"/>
                        </layout:HorizontalLayout>
                        <layout:HorizontalLayout class="sapUiTinyMarginBottom">
                            <Label class="sapUiTinyMarginEnd" text="{i18n>headerStartDate}"/>
                            <Text text="{path:'StartDate',formatter:'.formatter.fmtDate2'}"/>
                        </layout:HorizontalLayout>
                        <layout:HorizontalLayout class="sapUiTinyMarginTop sapUiTinyMarginBottom">
                            <Label class="sapUiTinyMarginEnd" text="{i18n>headerEndDate}"/>
                            <Text text="{path:'EndDate',formatter:'.formatter.fmtDate2'}"/>
                        </layout:HorizontalLayout>
                    </layout:VerticalLayout>
                    <layout:VerticalLayout>
                        <layout:VerticalLayout class="sapUiTinyMarginBottom">
                            <Label class="sapUiTinyMarginEnd" text="{i18n>headerStatus}"/>
                            <ObjectStatus class="statusTextSizeLarge sapUiTinyMarginTop" text="{path:'OfferStatus',formatter:'.formatter.fmtOfferStatus'}" state="{path:'OfferStatus',formatter:'.formatter.fmtOfferStateColor'}" />
                        </layout:VerticalLayout>
                    </layout:VerticalLayout>
                </layout:HorizontalLayout>
            </f:DynamicPageHeader>
        </f:header>

        <f:content>
            <IconTabBar select="onIcnTbarChange" selectedKey="{oModelControl3>/selectedKey}" id="idIconTabBar" expandable="false" expanded="{device>/isNoPhone}">
                <items>
                    <IconTabFilter text="{i18n>Details}" key="0">
                        <VBox id="idVbProfile" visible="{= ${oModelControl3>/mode}=== 'display'}">

                        </VBox>
                        <mvc:XMLView id="wizardViewBranching" async="true" visible="{= ${oModelControl3>/mode}=== 'edit'}" viewName="com.knpl.pragati.SchemeOffers.view.fragment.WizardOfferDetails" />
                    </IconTabFilter>
                    <IconTabFilter text="{i18n>OfferReport}" key="1">
                        <core:Fragment fragmentName="com.knpl.pragati.SchemeOffers.view.fragment.PainterTable1" type="XML"/>
                    </IconTabFilter>
                    <!-- <IconTabFilter text="{i18n>QualifiedPainter}" key="2">
                        <core:Fragment fragmentName="com.knpl.pragati.SchemeOffers.view.fragment.PainterTable2" type="XML"/>
                    </IconTabFilter> -->
                    <IconTabFilter text="{i18n>History}" key="3">
                        <core:Fragment fragmentName="com.knpl.pragati.SchemeOffers.view.fragment.OfferHistory" type="XML"/>
                    </IconTabFilter>
                    <IconTabFilter text="{i18n>ExecutionLog}" key="4">
                        <core:Fragment fragmentName="com.knpl.pragati.SchemeOffers.view.fragment.ExecutionLog" type="XML"/>
                    </IconTabFilter>
                    <IconTabFilter text="{i18n>delPainters}" key="5" visible="{IsPublished}">
                        <core:Fragment fragmentName="com.knpl.pragati.SchemeOffers.view.fragment.DeletedPainters" type="XML"/>
                    </IconTabFilter>


                </items>
            </IconTabBar>
        </f:content>
        <f:footer>
            <OverflowToolbar >
                <Text text="{i18n>Message3}" visible="{= ${RedemptionStatus}==='REDEEMING'}"/>
                <ToolbarSpacer/>

                <HBox visible="{= ${oModelControl3>/mode} === 'display' ? false : true }">
                    <Button class="sapUiTinyMarginEnd" id="edit" text="Edit" type="Emphasized" enabled="true" press="handleEditPress"/>
                      <Button class="sapUiTinyMarginEnd" id="cancel" text="Cancel" type="Ghost" visible="false" press="handleCancelPress"/>
                    <Button class="sapUiTinyMarginEnd" id="save" text="Save" enabled="{= ${OfferStatus}!=='EXPIRED'}" type="Emphasized" visible="false" press="handleSavePress"/>
                </HBox>

                <HBox visible="{= ${oModelControl3>/mode} === 'display' ? true : false }" justifyContent="SpaceBetween">
                    
                    <Button text="{i18n>Republish}" press="onRepublishPageSave"  visible="{parts:['OfferStatus','oModelControl3>/LoggedInUser/UserTypeId','OfferTypeId'],formatter:'.formatter.btnRepublishOffer'}" type="Success"  class="sapUiTinyMarginEnd"/>
                    <!-- <Button press="onPublishTemporary" type="Ghost" text="Temp {i18n>Publish} (only used for testing)" class="sapUiTinyMarginEnd" /> -->
                    <Button text="{i18n>Cancel}" type="Ghost" press="handleCancelPress" class="sapUiTinyMarginEnd"/>
                    <!-- <Button press="onActivate" text="{i18n>Activate}" type="Accept" class="sapUiTinyMarginEnd" visible="{= ${oModelControl3>/mode}=== 'display' &amp;&amp; ${IsActive}=== false}" />
                    <Button press="onDeactivate" text="{i18n>Deactivate}" type="Reject" class="sapUiTinyMarginEnd" visible="{= ${oModelControl3>/mode}=== 'display' &amp;&amp; ${IsActive}=== true}" /> -->
                    <!-- Send For Approval -->
                    <Button press="onOpenRemarksDialog('PENDING')" text="{i18n>SendForApproval}" type="Emphasized" class="sapUiTinyMarginEnd" visible="{parts:['OfferStatus','oModelControl3>/LoggedInUser/UserTypeId'],formatter:'.formatter.btnSendForApprovalCheck'}" />
                    <!-- Escalate -->
                    <Button press="onOpenRemarksDialog('ESCALATE')" text="{i18n>Escalate}" type="Critical" class="sapUiTinyMarginEnd" visible="{parts:['OfferStatus','oModelControl3>/LoggedInUser/UserTypeId','AssigneUserType'],formatter:'.formatter.btnEscalate'}" />
                    <!-- Approve Reject -->
                    <Button press="onOpenRemarksDialog('REJECTED')" text="{i18n>Reject}" type="Reject" class="sapUiTinyMarginEnd" visible="{parts:['OfferStatus','oModelControl3>/LoggedInUser/UserTypeId'],formatter:'.formatter.btnApproveDisplay'}" />
                    <Button press="onOpenRemarksDialog('APPROVED')" text="{i18n>Approve}" type="Emphasized" class="sapUiTinyMarginEnd" visible="{parts:['OfferStatus','oModelControl3>/LoggedInUser/UserTypeId'],formatter:'.formatter.btnApproveDisplay'}" />
                    <!-- Publish -->
                    <Button press="onOpenRemarksDialog('PUBLISHED')" text="{i18n>Publish}" type="Success" class="sapUiTinyMarginEnd" visible="{parts:['OfferStatus','oModelControl3>/LoggedInUser/UserTypeId'],formatter:'.formatter.btnPublished'}" />
                    <!-- Redemption Button -->
                         <Button enabled="{parts:['RedemptionStatus','oModelControl3>/Buttons/RedeemEnable' ],formatter:'.formatter.btnRedeenAllEnable' }" press=".onApplyRedemption" text="{i18n>RedeemAll}" type="Ghost" class="sapUiTinyMarginEnd" visible="{parts:['RedemptionStatus','oModelControl3>/Buttons/Redeem'],formatter:'.formatter.btnRedeemCheck'}" />
                    <!-- SAVE Button -->
                    <!-- <Button press="onDetailPageSave" enabled="{= ${OfferStatus}!=='EXPIRED'}" visible="{= ${oModelControl3>/LoggedInUser/UserTypeId}===6 || ${oModelControl3>/LoggedInUser/UserTypeId}===7 }" text="{i18n>saveBtnText}" type="Emphasized" class="sapUiTinyMarginEnd" /> -->
                
                     <Button press="onDetailPageSave" visible="{parts: ['OfferStatus','oModelControl3>/LoggedInUser/UserTypeId'],formatter:'.formatter.bntSaveDetailsOfferVisible' }" text="{i18n>saveBtnText}" type="Emphasized" class="sapUiTinyMarginEnd" />           
                </HBox>


            </OverflowToolbar>

        </f:footer>
    </f:DynamicPage>
</mvc:View>
